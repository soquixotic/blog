"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[699],{699:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var c=t(8),r=t(7491),a=t(8844),s=t(1017),u=t(8900),i={1:"CNY",2:"HKD",3:"USD"},l={1:"\uffe5",2:"HK$",3:"$"};function o(){return(o=(0,s.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("https://api.zymx.tech/family/accounts");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,s.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("https://api.zymx.tech/account/create",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=(0,s.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("https://api.zymx.tech/account/update",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=(0,s.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("https://api.zymx.tech/family/create",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return m.apply(this,arguments)}function m(){return(m=(0,s.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:(0,u.Nh)()}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,n){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)((0,a.Z)().mark((function e(n,t){var c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&"),e.next=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:(0,u.Nh)()},body:c});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=t(4612),Z=t(7712),w=t(5841),g=t(7176),N=t(3774),C=t(958),k=t(2978);function A(e){var n,t,u,l,o=e.onAccountCreated,f=e.account,h=(0,r.useState)(!1),x=(0,c.Z)(h,2),v=x[0],m=x[1],y=null!==(n=null===f||void 0===f?void 0:f.id)&&void 0!==n?n:0,b=(0,r.useState)(null!==(t=null===f||void 0===f?void 0:f.name)&&void 0!==t?t:""),A=(0,c.Z)(b,2),S=A[0],z=A[1],F=(0,r.useState)(null!==(u=null===f||void 0===f?void 0:f.balance)&&void 0!==u?u:0),P=(0,c.Z)(F,2),U=P[0],T=P[1],E=(0,r.useState)(null!==(l=null===f||void 0===f?void 0:f.currency)&&void 0!==l?l:1),O=(0,c.Z)(E,2),R=O[0],B=O[1],D=(0,r.useState)(!1),G=(0,c.Z)(D,2),H=G[0],I=G[1],K=N.ZP.useMessage(),L=(0,c.Z)(K,2),M=L[0],Y=L[1];(0,r.useEffect)((function(){var e,n,t;v&&(z(null!==(e=null===f||void 0===f?void 0:f.name)&&void 0!==e?e:""),T(null!==(n=null===f||void 0===f?void 0:f.balance)&&void 0!==n?n:0),B(null!==(t=null===f||void 0===f?void 0:f.currency)&&void 0!==t?t:1),I(!1))}),[null===f||void 0===f?void 0:f.balance,null===f||void 0===f?void 0:f.currency,null===f||void 0===f?void 0:f.name,v]);var $=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==y){e.next=6;break}return e.next=3,d({name:S,balance:U,currency:R});case 3:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,p({id:y,name:S,balance:U});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,k.jsxs)("div",{children:[Y,(0,k.jsx)(C.ZP,{type:"link",onClick:function(){m(!0)},children:0===y?"Add":"Edit"}),(0,k.jsx)(j.Z,{title:0===y?"Create Account":"Update Account",open:v,onCancel:function(){return m(!1)},onOk:function(){console.log(S,U,R),I(!0),$().then((function(e){if(0===e.code)return m(!1),null===o||void 0===o||o(e.data.account),void M.success("done!");M.error("Failed to change account.")})).catch((function(e){I(!1),M.error("Failed to change account.")})).finally((function(){I(!1)}))},confirmLoading:H,children:(0,k.jsxs)("div",{className:"flex flex-col mt-5 space-y-2",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("label",{className:"w-48",children:"Account name: "}),(0,k.jsx)(g.Z,{value:S,placeholder:"eg: Cash, Bank, Alipay, Wechat Pay, etc.",onChange:function(e){z(e.target.value)}})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("label",{className:"w-48",children:"Balance: "}),(0,k.jsx)(w.Z,{className:"w-full",value:U,onChange:function(e){return T(e)}})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("label",{className:"w-48",children:"Currency: "}),(0,k.jsx)(Z.Z,{disabled:0!==y,className:"w-full",value:R,onChange:function(e){return B(e)},options:[{value:1,label:i[1]}]})]})]})})]})}function S(){var e=(0,r.useState)(!1),n=(0,c.Z)(e,2),t=n[0],a=n[1],s=(0,r.useState)(""),u=(0,c.Z)(s,2),i=u[0],l=u[1],o=N.ZP.useMessage(),d=(0,c.Z)(o,2),f=d[0],p=d[1],h=(0,r.useState)(!1),v=(0,c.Z)(h,2),m=v[0],y=v[1];return(0,k.jsxs)("div",{children:[p,(0,k.jsx)(C.ZP,{onClick:function(){return a(!0)},children:"Create Family"}),(0,k.jsx)(j.Z,{open:t,onCancel:function(){a(!1)},onOk:function(){(function(e){return x.apply(this,arguments)})({name:i}).then((function(){f.success("Family created"),a(!1)})).catch((function(e){f.error("Failed to create family")})).finally((function(){y(!1)}))},confirmLoading:m,children:(0,k.jsxs)("div",{className:"flex justify-between items-center mt-5",children:[(0,k.jsx)("label",{className:"w-48",children:"Family name: "}),(0,k.jsx)(g.Z,{value:i,onChange:function(e){l(e.target.value)}})]})})]})}function z(e){var n=e.account,t=e.onAccountUpdated;return(0,k.jsxs)("div",{className:"flex flex-col w-28 h-28 bg-blue-200 bg-opacity-80 rounded-lg p-2 justify-center space-y-2",children:[(0,k.jsx)("div",{className:"font-bold text-base",children:n.name}),(0,k.jsxs)("div",{className:"",children:[l[n.currency]," ",n.balance]}),(0,k.jsx)("div",{className:"w-full flex items-center justify-center",children:(0,k.jsx)(A,{account:n,onAccountCreated:function(){t()}})})]})}function F(){var e,n=(0,r.useState)([]),t=(0,c.Z)(n,2),a=t[0],s=t[1],i=(0,u.bG)(),l=function(){(function(){return o.apply(this,arguments)})().then((function(e){0===e.code&&s(e.data)})).catch((function(e){console.log(e)}))};(0,r.useEffect)((function(){l()}),[]);var d=null!==(e=null===a||void 0===a?void 0:a.reduce((function(e,n){return e+n.balance}),0))&&void 0!==e?e:0;return(0,k.jsxs)("div",{className:"w-full h-full flex flex-col p-4",children:[(0,k.jsxs)("div",{className:"w-full h-24 rounded-lg bg-blue-300 bg-opacity-80 flex items-center justify-between p-4 mb-4",children:[(0,k.jsxs)("div",{className:"text-2xl",children:["Total CNY ",d]}),(0,k.jsx)("div",{className:"flex flex-col space-y-2",children:0===i.family_id&&(0,k.jsx)(S,{})})]}),(0,k.jsx)("div",{className:"font-bold mb-1 text-lg",children:"Accounts"}),(0,k.jsxs)("div",{className:"w-full rounded-lg bg-white bg-opacity-80 p-2 flex space-x-2 mb-4",children:[a.map((function(e){return(0,k.jsx)(z,{account:e,onAccountUpdated:function(){return l()}})})),(0,k.jsx)("div",{className:"flex flex-col w-28 h-28 bg-blue-100 bg-opacity-80 rounded-lg p-2 items-center justify-center space-y-2",children:(0,k.jsx)(A,{onAccountCreated:function(e){l()}})})]}),(0,k.jsx)("div",{className:"font-bold mb-1 text-lg",children:"Records"}),(0,k.jsx)("div",{className:"w-full h-full rounded-lg bg-white bg-opacity-80",children:"records"})]})}}}]);
//# sourceMappingURL=699.f9380802.chunk.js.map