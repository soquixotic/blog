"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[699],{699:function(e,n,t){t.r(n),t.d(n,{default:function(){return z}});var r=t(8),c=t(7491),a=t(8844),u=t(1017),i=t(8900),s={1:"CNY",2:"HKG",3:"USD"};function o(){return(o=(0,u.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("https://api.zymx.tech/family/accounts");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=(0,u.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("https://api.zymx.tech/account/create",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return p.apply(this,arguments)}function p(){return(p=(0,u.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("https://api.zymx.tech/account/update",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=(0,u.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("https://api.zymx.tech/family/create",n);case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=(0,u.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:(0,i.Nh)()}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,n){return y.apply(this,arguments)}function y(){return(y=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&"),e.next=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:(0,i.Nh)()},body:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=t(4612),b=t(7712),Z=t(5841),w=t(7176),g=t(3774),N=t(958),C=t(2978);function k(e){var n,t,i,o,d=e.onAccountCreated,p=e.account,h=(0,c.useState)(!1),v=(0,r.Z)(h,2),x=v[0],m=v[1],y=null!==(n=null===p||void 0===p?void 0:p.id)&&void 0!==n?n:0,k=(0,c.useState)(null!==(t=null===p||void 0===p?void 0:p.name)&&void 0!==t?t:""),A=(0,r.Z)(k,2),S=A[0],z=A[1],F=(0,c.useState)(null!==(i=null===p||void 0===p?void 0:p.balance)&&void 0!==i?i:0),P=(0,r.Z)(F,2),U=P[0],T=P[1],E=(0,c.useState)(null!==(o=null===p||void 0===p?void 0:p.currency)&&void 0!==o?o:1),G=(0,r.Z)(E,2),O=G[0],B=G[1],I=(0,c.useState)(!1),L=(0,r.Z)(I,2),M=L[0],R=L[1],W=g.ZP.useMessage(),Y=(0,r.Z)(W,2),D=Y[0],H=Y[1];(0,c.useEffect)((function(){var e,n,t;x&&(z(null!==(e=null===p||void 0===p?void 0:p.name)&&void 0!==e?e:""),T(null!==(n=null===p||void 0===p?void 0:p.balance)&&void 0!==n?n:0),B(null!==(t=null===p||void 0===p?void 0:p.currency)&&void 0!==t?t:1),R(!1))}),[null===p||void 0===p?void 0:p.balance,null===p||void 0===p?void 0:p.currency,null===p||void 0===p?void 0:p.name,x]);var K=function(){var e=(0,u.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==y){e.next=6;break}return e.next=3,l({name:S,balance:U,currency:O});case 3:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,f({id:y,name:S,balance:U});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{children:[H,(0,C.jsx)(N.ZP,{type:"link",onClick:function(){m(!0)},children:0===y?"Add Account":"Edit"}),(0,C.jsx)(j.Z,{title:0===y?"Create Account":"Update Account",open:x,onCancel:function(){return m(!1)},onOk:function(){console.log(S,U,O),R(!0),K().then((function(e){if(0===e.code)return m(!1),null===d||void 0===d||d(e.data.account),void D.success("done!");D.error("Failed to change account.")})).catch((function(e){R(!1),D.error("Failed to change account.")})).finally((function(){R(!1)}))},confirmLoading:M,children:(0,C.jsxs)("div",{className:"flex flex-col mt-5 space-y-2",children:[(0,C.jsxs)("div",{className:"flex justify-between items-center",children:[(0,C.jsx)("label",{className:"w-48",children:"Account name: "}),(0,C.jsx)(w.Z,{value:S,placeholder:"eg: Cash, Bank, Alipay, Wechat Pay, etc.",onChange:function(e){z(e.target.value)}})]}),(0,C.jsxs)("div",{className:"flex justify-between items-center",children:[(0,C.jsx)("label",{className:"w-48",children:"Balance: "}),(0,C.jsx)(Z.Z,{className:"w-full",value:U,onChange:function(e){return T(e)}})]}),(0,C.jsxs)("div",{className:"flex justify-between items-center",children:[(0,C.jsx)("label",{className:"w-48",children:"Currency: "}),(0,C.jsx)(b.Z,{disabled:0!==y,className:"w-full",value:O,onChange:function(e){return B(e)},options:[{value:1,label:s[1]}]})]})]})})]})}function A(){var e=(0,c.useState)(!1),n=(0,r.Z)(e,2),t=n[0],a=n[1],u=(0,c.useState)(""),i=(0,r.Z)(u,2),s=i[0],o=i[1],l=g.ZP.useMessage(),d=(0,r.Z)(l,2),f=d[0],p=d[1],v=(0,c.useState)(!1),x=(0,r.Z)(v,2),m=x[0],y=x[1];return(0,C.jsxs)("div",{children:[p,(0,C.jsx)(N.ZP,{onClick:function(){return a(!0)},children:"Create Family"}),(0,C.jsx)(j.Z,{open:t,onCancel:function(){a(!1)},onOk:function(){(function(e){return h.apply(this,arguments)})({name:s}).then((function(){f.success("Family created"),a(!1)})).catch((function(e){f.error("Failed to create family")})).finally((function(){y(!1)}))},confirmLoading:m,children:(0,C.jsxs)("div",{className:"flex justify-between items-center mt-5",children:[(0,C.jsx)("label",{className:"w-48",children:"Family name: "}),(0,C.jsx)(w.Z,{value:s,onChange:function(e){o(e.target.value)}})]})})]})}function S(e){var n=e.account,t=e.onAccountUpdated;return(0,C.jsxs)("div",{className:"flex flex-col w-24 h-24 bg-blue-200 bg-opacity-80 rounded-lg p-2 justify-center space-y-2",children:[(0,C.jsx)("div",{className:"font-bold",children:n.name}),(0,C.jsxs)("div",{className:"",children:[s[n.currency]," ",n.balance]}),(0,C.jsx)("div",{className:"w-full flex items-center justify-center",children:(0,C.jsx)(k,{account:n,onAccountCreated:function(){t()}})})]})}function z(){var e,n=(0,c.useState)([]),t=(0,r.Z)(n,2),a=t[0],u=t[1],s=(0,i.bG)(),l=function(){(function(){return o.apply(this,arguments)})().then((function(e){0===e.code&&u(e.data)})).catch((function(e){console.log(e)}))};(0,c.useEffect)((function(){l()}),[]);var d=null!==(e=null===a||void 0===a?void 0:a.reduce((function(e,n){return e+n.balance}),0))&&void 0!==e?e:0;return(0,C.jsxs)("div",{className:"w-full h-full flex flex-col p-4",children:[(0,C.jsxs)("div",{className:"w-full h-24 rounded-lg bg-blue-300 bg-opacity-80 flex items-center justify-between p-4",children:[(0,C.jsxs)("div",{className:"text-2xl",children:["Total CNY ",d]}),(0,C.jsxs)("div",{className:"flex flex-col space-y-2",children:[0===s.family_id&&(0,C.jsx)(A,{}),(0,C.jsx)(k,{onAccountCreated:function(e){l()}})]})]}),(0,C.jsx)("div",{className:"w-full rounded-lg bg-white bg-opacity-80 mt-4 p-2 flex space-x-2",children:a.map((function(e){return(0,C.jsx)(S,{account:e,onAccountUpdated:function(){return l()}})}))}),(0,C.jsx)("div",{className:"w-full h-full rounded-lg bg-white bg-opacity-80 mt-4",children:"records"})]})}},8900:function(e,n,t){t.d(n,{Nh:function(){return a},aW:function(){return c},bG:function(){return u}});var r={};function c(e){r=e}function a(){var e;return null!==(e="Bear "+r.token)&&void 0!==e?e:""}function u(){var e;return null!==(e=r.user)&&void 0!==e?e:{}}}}]);
//# sourceMappingURL=699.f6e4979f.chunk.js.map