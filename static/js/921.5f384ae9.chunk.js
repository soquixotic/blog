"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[921],{3816:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var r=n(4951),o=n(8),a=n(3774),c=n(7176),i=n(958),s=n(9454),u=n(2543),d=n(7491),l=n(8844),p=n(1017),f=n(8900);function h(){return(h=(0,p.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("https://api.zymx.tech/gpt/gen-image",{prompt:t});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=(0,p.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.keys(n).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&"),e.next=3,fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:(0,f.Nh)()},body:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=n(6135),b=n(2978);function x(){var e=(0,d.useState)(!1),t=(0,o.Z)(e,2),n=t[0],l=t[1],p=(0,d.useState)(""),m=(0,o.Z)(p,2),g=m[0],x=m[1],w=(0,f.pG)(),y=(0,o.Z)(w,1)[0],j=(0,f.v$)(),Z=(0,d.useState)([]),S=(0,o.Z)(Z,2),N=S[0],k=S[1],C=a.ZP.useMessage(),R=(0,o.Z)(C,2),E=R[0],T=R[1];return(0,b.jsxs)("div",{className:"p-4 space-y-4 pb-24",children:[T,(0,b.jsxs)("div",{className:"font-bold text-red-500 p-2 bg-red-50 bg-opacity-80 rounded-lg",children:["Careful!!! ",(0,b.jsx)("br",{}),"Once you refresh the page, you're unable to find back the images. Make sure save the images you like before you leave."]}),(0,b.jsx)("div",{className:"text-base font-bold",children:"Prompt:"}),(0,b.jsx)(c.Z.TextArea,{rows:4,value:g,placeholder:"Input your prompt here. You have to input 10 characters at least. ",onChange:function(e){return x(e.target.value)},disabled:n}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(i.ZP,{type:"primary",loading:n,onClick:function(){j.token?(l(!0),function(e){return h.apply(this,arguments)}(g).then((function(e){0===e.code?k([e.data].concat((0,r.Z)(N))):E.error(e.message)})).catch((function(e){console.log("failed to gen image. ",e),E.error("Failed to gen image.")})).finally((function(){l(!1)}))):y()},disabled:g.length<10,children:"Gen!"}),(0,b.jsx)(i.ZP,{type:"default",loading:n,onClick:function(){l(!0),function(e,t,n,r){var o=new TextDecoder("utf-8"),a=[e],c={prev_text:e},i=Object.keys(c).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e])})).join("&");try{fetch("https://api.zymx.tech/gpt/continue-write",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:(0,f.Nh)()},body:i}).then((function(e){var t=e.body.getReader();return new ReadableStream({start:function(e){!function n(){t.read().then((function(t){var r=t.done,o=t.value;r?e.close():(e.enqueue(o),n())}))}()}})})).then((function(e){var r=e.getReader();r.read().then((function e(c){var i=c.done,s=c.value;if(i)return n(),void console.log("Stream complete");var u=o.decode(s);console.log("Received:",u),a.push(u),t(a.join("")),r.read().then(e)}))})).catch((function(e){r(),n(),console.error("Error:",e)}))}catch(s){r(),console.error("Error:",s)}}(g,(function(e){x(e)}),(function(){l(!1)}),(function(){E.error("Failed to AI write")}))},disabled:g.length<1,children:"AI Write"})]}),(0,b.jsx)("div",{className:"text-base font-bold",children:"Result:"}),(0,b.jsx)("div",{className:"w-full overflow-auto",children:(0,b.jsx)("div",{className:"w-fit",children:(0,b.jsxs)("div",{className:"flex space-x-2",children:[n&&(0,b.jsx)("div",{className:"w-28 h-28 flex items-center justify-center bg-white bg-opacity-70 rounded-lg",children:(0,b.jsx)(s.Z,{})}),N.map((function(e,t){var n,r=e.data[0],o=null!==(n=r.url)&&void 0!==n?n:"data:image/png;base64,".concat(r.b64_json);return(0,b.jsx)("div",{className:"w-28 h-28 rounded-lg",children:(0,b.jsx)(u.Z,{src:o})},t)}))]})})}),(0,b.jsx)("div",{children:N.map((function(e,t){var n,r=e.data[0],o=null!==(n=r.url)&&void 0!==n?n:"data:image/png;base64,".concat(r.b64_json);return(0,b.jsxs)("div",{className:"bg-white bg-opacity-90 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"font-bold mb-2",children:(0,v.i)(e.created)}),(0,b.jsx)("div",{className:"mb-2 bg-gray-300 rounded-lg p-2 bg-opacity-50",children:r.revised_prompt}),(0,b.jsx)("img",{src:o,alt:r.revised_prompt,className:"w-full h-full"})]},t)}))})]})}},6135:function(e,t,n){function r(e){var t=new Date(1e3*e);return"".concat(t.getFullYear(),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getDate().toString().padStart(2,"0")," ").concat(t.getHours().toString().padStart(2,"0"),":").concat(t.getMinutes().toString().padStart(2,"0"),":").concat(t.getSeconds().toString().padStart(2,"0"))}n.d(t,{i:function(){return r}})},9348:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(2796);function o(e,t,n,o){var a=r.unstable_batchedUpdates?function(e){r.unstable_batchedUpdates(n,e)}:n;return null!==e&&void 0!==e&&e.addEventListener&&e.addEventListener(t,a,o),{remove:function(){null!==e&&void 0!==e&&e.removeEventListener&&e.removeEventListener(t,a,o)}}}},4064:function(e,t,n){n.d(t,{g1:function(){return r},os:function(){return o}});function r(){return{width:document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight}}function o(e){var t=e.getBoundingClientRect(),n=document.documentElement;return{left:t.left+(window.pageXOffset||n.scrollLeft)-(n.clientLeft||document.body.clientLeft||0),top:t.top+(window.pageYOffset||n.scrollTop)-(n.clientTop||document.body.clientTop||0)}}}}]);
//# sourceMappingURL=921.5f384ae9.chunk.js.map